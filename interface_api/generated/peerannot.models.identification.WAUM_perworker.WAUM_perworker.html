

<!DOCTYPE html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="docsearch:name" content="peerannot" />
    <meta name="docsearch:package_type" content="" />
    <meta name="docsearch:release" content="0.0.1.post41" />
    <meta name="docsearch:version" content="0.0.1.post41" />
    
      <title>WAUM_perworker &mdash; peerannot 0.0.1.post41 documentation</title>
    
      <link rel="icon" href="../../_static/logo.png" />
    <link rel="stylesheet" href="../../_static/bootstrap-icons.css" type="text/css" />
          <!-- add (1) pathto "_CascadingStyleSheet('_static/pygments.css', priority=200, rel='stylesheet', type='text/css')" -->
          <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=83e35b93" />
          <!-- add (1) pathto "_CascadingStyleSheet('_static/copybutton.css', priority=500, rel='stylesheet', type='text/css')" -->
          <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
          <!-- add (1) pathto "_CascadingStyleSheet('_static/pygments_dark.css', priority=500, rel='stylesheet', type='text/css', media='(prefers-color-scheme: dark)', id='pygments_dark_css')" -->
          <link id="pygments_dark_css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css" href="../../_static/pygments_dark.css?v=b20cc3f5" />
          <!-- add (1) pathto "_CascadingStyleSheet('_static/sphinx-design.min.css', priority=500, rel='stylesheet', type='text/css')" -->
          <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=87e54e7c" />
          <!-- add (1) pathto "_CascadingStyleSheet('_static/colorsets/sphinx-nefertiti-default-0.3.2.min.css', priority=500, rel='stylesheet', type='text/css')" -->
          <link rel="stylesheet" type="text/css" href="../../_static/colorsets/sphinx-nefertiti-default-0.3.2.min.css" />
          <!-- add (1) pathto "_CascadingStyleSheet('_static/fonts/nunito/stylesheet.css', priority=500, rel='stylesheet', type='text/css')" -->
          <link rel="stylesheet" type="text/css" href="../../_static/fonts/nunito/stylesheet.css" />
          <!-- add (1) pathto "_CascadingStyleSheet('_static/fonts/red-hat-mono/stylesheet.css', priority=500, rel='stylesheet', type='text/css')" -->
          <link rel="stylesheet" type="text/css" href="../../_static/fonts/red-hat-mono/stylesheet.css" />
        <link rel="index" title="Index" href="../../genindex.html" />
        <link rel="search" title="Search" href="../../search.html" />
        <link rel="top" title="peerannot 0.0.1.post41 documentation" href="#" />
        <link rel="up" title="API identify" href="../api_identify.html" />
        <link rel="next" title="WAUM" href="peerannot.models.identification.WAUM.WAUM.html" />
        <link rel="prev" title="Entropy" href="peerannot.models.identification.entropy.Entropy.html" />
    <style>
      :root {
        --nftt-body-font-family: "Nunito", var(--nftt-font-sans-serif) !important;
        --nftt-font-monospace: "Red Hat Mono", var(--nftt-font-family-monospace) !important;
        --nftt-project-name-font: var(--nftt-body-font-family);
        --nftt-documentation-font: var(--nftt-body-font-family);
        --nftt-doc-headers-font: "Georgia", var(--nftt-documentation-font);}
      h1 *, h2 *, h3 *, h4 *, h5 *, h6 * { font-size: inherit; }
    </style>
  </head>
  <body>
    <header class="navbar navbar-expand-xl navbar-dark nftt-navbar flex-column fixed-top">
      <div class="skip-links container-fluid visually-hidden-focusable overflow-hidden justify-content-start flex-grow-1">
        <div class="border-bottom mb-2 pb-2 w-100">
          <a class="d-none d-md-inline-flex p-2 m-1" href="#sidebar-filter">Skip to docs navigation</a>
          <a class="d-inline-flex p-2 m-1" href="#content">Skip to main content</a>
        </div>
      </div>
      <nav class="container-xxl nftt-gutter flex-wrap flex-xl-nowrap" aria-label="Main navigation">
        <div class="nftt-navbar-toggler">
          <button class="navbar-toggler p-2" type="button" data-bs-toggle="offcanvas" data-bs-target="#sidebar" aria-controls="sidebar" aria-label="Toggle documentation navigation">
            <i class="bi bi-list"></i>
          </button>
        </div>
          <a href="../../index.html"
              
              class="navbar-brand p-0 me-0 md-lg-2"
          ><span class="brand-text">peerannot</span></a>
        
        <div class="d-flex d-xl-none">
          <button class="navbar-toggler p-2" type="button" data-bs-toggle="offcanvas" data-bs-target="#nfttSearch" aria-controls="nfttSearch" aria-label="Search">
            <i class="bi bi-search"></i>
          </button>
          <button class="navbar-toggler p-2" type="button" data-bs-toggle="offcanvas" data-bs-target="#nfttNavbar" aria-controls="nfttNavbar" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
        </div>
        
<div class="offcanvas-xl offcanvas-end flex-grow-1" tabindex="-1" id="nfttSearch" aria-labelledby="nfttSearchOffcanvasLabel" data-bs-scroll="true">
  <div class="offcanvas-header px-4 pb-0">
    <h5 class="offcanvas-title fw-bold" id="nfttSearchOffcanvasLabel">Search the documentation</h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close" data-bs-target="#nfttSearch"></button>
  </div>
  <div class="offcanvas-body p-4 pt-0 p-xl-0 px-xl-3">
    <hr class="d-xl-none text-white-50">
    <ul class="navbar-nav flex-row align-items-center flex-wrap ms-md-auto">
      <li class="nav-item col-12 col-xl-auto">
        <form id="nftt-search-form" action="../../search.html" method="get">
          <div class="input-group">
            <input type="text" name="q" class="form-control" placeholder="Search docs" aria-label="Search" aria-describedby="button-search">
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
            <button class="btn btn-primary" type="submit" id="button-search" aria-label="Search"><i class="bi bi-search"></i></button>
          </div>
        </form>
      </li>
    </ul>
  </div>
</div>

        <div class="offcanvas-xl offcanvas-end" tabindex="-1" id="nfttNavbar" aria-labelledby="nfttNavbarOffcanvasLabel" data-bs-scroll="true">
          <div class="offcanvas-header px-4 pb-0">
            <div class="offcanvas-title navbar-brand" id="nfttNavbarOffcanvasLabel"><span class="brand-text">Nefertiti for Sphinx</span></div>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Close" data-bs-target="#nfttNavbar"></button>
          </div>
          <div class="offcanvas-body p-4 pt-0 p-xl-0 px-xl-3">
            <hr class="d-xl-none text-white-50">
            <ul class="navbar-nav flex-row align-items-center flex-wrap ms-lg-auto">
              
              <!-- version_dropdown.html -->

              
              <!-- colorscheme_dropdown.html -->
<li class="nav-item dropdown">
  <a class="nav-link d-flex py-2 px-0 px-xl-2 dropdown-toggle align-items-center" id="snftt-luz" href="#" data-bs-toggle="dropdown" data-bs-display="static" aria-expanded="false" aria-label="Toggle light/dark">
    <i class="bi bi-circle-half" data-snftt-luz-icon-active></i>
    <span id="snftt-luz-text" class="d-xl-none small ms-2">Toggle light/dark</span>
  </a>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="snftt-luz-text">
    <li>
      <h6 class="dropdown-header">Light/dark</h6>
    </li>
    <li>
      <a class="dropdown-item d-flex align-items-center" data-snftt-luz="light" href="#" aria-pressed="false">
        <span class="small">
          <i class="bi bi-sun" data-snftt-luz-icon="light"></i>
        </span>
        <span class="small ms-3">Light</span>
        <i class="bi bi-check ms-auto"></i>
      </a>
    </li>
    <li>
      <a class="dropdown-item d-flex align-items-center" data-snftt-luz="dark" href="#" aria-pressed="false">
        <span class="small">
          <i class="bi bi-moon-stars" data-snftt-luz-icon="dark"></i>
        </span>
        <span class="small ms-3">Dark</span>
        <i class="bi bi-check ms-auto"></i>
      </a>
    </li>
    <li>
      <a class="dropdown-item current d-flex align-items-center" data-snftt-luz="default" href="#" aria-pressed="false">
        <span class="small">
          <i class="bi bi-circle-half" data-snftt-luz-icon="default"></i>
        </span>
        <span class="small ms-3">Default</span>
        <i class="bi bi-check ms-auto"></i>
      </a>
    </li>
  </ul>
</li>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <div class="container-fluid flex-grow-1">
      <div class="nftt-gutter nftt-page">
        <aside class="nftt-sidebar ">
          <div class="nftt-sidebar-content">
            
            <div class="title d-none d-xl-block">
              <i class="bi bi-book"></i>&nbsp;&nbsp;<span>Index</span>
            </div>
            <div id="sidebar" tabindex="-1" class="offcanvas-xl offcanvas-start" aria-labelledby="nfttSidebarOffcanvasLabel">
                <!-- danirus sidebartemplate: "globaltoc.html" --><div class="offcanvas-header border-bottom">
  <h5 class="offcanvas-title fw-bold" id="nfttSidebarOffcanvasLabel">
    Table of contents
  </h5>
  <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close" data-bs-target="#sidebar"></button>
</div>

<div class="offcanvas-body">
  <nav class="toc" aria-label="Main menu">
    <div class="mb-3 p-1 pt-3 pb-4 border-bottom">
      <input id="sidebar-filter" type="text" name="filter" class="form-control form-control-sm" placeholder="filter" aria-label="filter">
    </div>
    <ul>
<li class="toctree-l1"><a class="reference internal" href="../../get_started.html">Get started</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/add_dataset.html">Add a dataset to peerannot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/add_strategy.html">Add a strategy in peerannot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/run_aggregation_notebook.html">Data generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/run_aggregation_notebook.html#Command-Line-Aggregation">Command Line Aggregation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/run_aggregation_notebook.html#API-Aggregation">API Aggregation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/run_pipeline_notebook.html">Simulate the dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/run_pipeline_notebook.html#Value-of-the-krippendorff-alpha">Value of the krippendorff alpha</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/run_pipeline_notebook.html#Identify-spammers">Identify spammers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/run_pipeline_notebook.html#Aggregation-with-and-without-identification">Aggregation with and without identification</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
</ul>

  </nav>
  <template data-toggle-item-template>
    <button class="btn btn-sm btn-link toctree-expand" type="button">
      <i class="bi bi-caret-right"></i>
      <span class="visually-hidden">Toggle menu contents</span>
    </button>
  </template>
</div>
            </div>
            
          </div>
        </aside>
        <article id="content" class="nftt-content" role="main">
    <section id="waum-perworker">
<h1>WAUM_perworker<a class="headerlink" href="#waum-perworker" title="Link to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="peerannot.models.identification.WAUM_perworker.WAUM_perworker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">WAUM_perworker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tasks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">answers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">criterion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_pleiss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#peerannot.models.identification.WAUM_perworker.WAUM_perworker" title="Link to this definition">¶</a></dt>
<dd><section id="waum-per-worker-lefort-et-al-2024-in-tmlr">
<h2>WAUM per worker (Lefort et al. 2024 in TMLR)<a class="headerlink" href="#waum-per-worker-lefort-et-al-2024-in-tmlr" title="Link to this heading">¶</a></h2>
<p>Measures the WAUM per worker and task without duplication for each task by the number of workers that responded.
Once too prone to confusion tasks are removed, the final label is a
weighted distribution by the diagonal of the estimated confusion matrix.</p>
<p>Using:</p>
<ul class="simple">
<li><p>Margin estimation</p></li>
<li><p>Trust score per worker and task</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="peerannot.models.identification.WAUM_perworker.WAUM_perworker.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tasks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">answers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">criterion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_pleiss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#peerannot.models.identification.WAUM_perworker.WAUM_perworker.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Compute the WAUM score for each task using a stacked version of the dataset (stacked over workers). Each classifier is trained on <span class="math notranslate nohighlight">\((x_i, y_i^{(j)})_i\)</span> for a given worker <span class="math notranslate nohighlight">\(j\)</span>. THE WAUM per worker writes:</p>
<div class="math notranslate nohighlight">
\[\mathrm{WAUM}(x_i)= \frac{1}{\displaystyle\sum_{j'\in\mathcal{A}(x_i)} s^{(j')}(x_i)}\sum_{j\in\mathcal{A}(x_i)} s^{(j)}(x_i) \mathrm{AUM}\big(x_i, y_i^{(j)}\big)\]</div>
<p>where the difference with the classical WAUM is that the weights are notinfluenced by other workers’ answers in the classifier’s prediction. In low-number of votes per worker regime, the classical WAUM is recommended.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tasks</strong> (<em>torch Dataset</em>) – Loader for dataset of tasks as <span class="math notranslate nohighlight">\((x_i, y_i^{(j)}, w^{(j)}, y_i^\star, i)_{(i,j)}\)</span></p></li>
<li><p><strong>answers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a>) – <p>Dictionary of workers answers with format</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nx">task0</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">worker0</span><span class="o">:</span><span class="w"> </span><span class="nx">label</span><span class="p">,</span><span class="w"> </span><span class="nx">worker1</span><span class="o">:</span><span class="w"> </span><span class="nx">label</span><span class="p">},</span>
<span class="w">    </span><span class="nx">task1</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">worker1</span><span class="o">:</span><span class="w"> </span><span class="nx">label</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</p></li>
<li><p><strong>n_classes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of possible classes, defaults to 2</p></li>
<li><p><strong>model</strong> (<em>torch Module</em>) – Neural network to use</p></li>
<li><p><strong>criterion</strong> (<em>torch loss</em>) – loss to minimize for the network</p></li>
<li><p><strong>optimizer</strong> (<em>torch optimizer</em>) – Optimization strategy for the minimization</p></li>
<li><p><strong>n_epoch</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of epochs</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Print details in log, defaults to False</p></li>
<li><p><strong>use_pleiss</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Use Pleiss margin instead of Yang, defaults to False</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="peerannot.models.identification.WAUM_perworker.WAUM_perworker.run_DS">
<span class="sig-name descname"><span class="pre">run_DS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#peerannot.models.identification.WAUM_perworker.WAUM_perworker.run_DS" title="Link to this definition">¶</a></dt>
<dd><p>Run Dawid and Skene aggregation model. It <code class="docutils literal notranslate"><span class="pre">cut=True</span></code>, runs it on the pruned dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cut</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Run on full dataset or dataset pruned from lower WAUM tasks, defaults to False</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="peerannot.models.identification.WAUM_perworker.WAUM_perworker.make_step">
<span class="sig-name descname"><span class="pre">make_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#peerannot.models.identification.WAUM_perworker.WAUM_perworker.make_step" title="Link to this definition">¶</a></dt>
<dd><p>One optimization step</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> (<em>batch</em>) – <p>Batch of tasks</p>
<dl class="simple">
<dt>Batch:</dt><dd><ul class="simple">
<li><p>index 0: tasks <span class="math notranslate nohighlight">\((x_i)_i\)</span></p></li>
<li><p>index 1: labels</p></li>
<li><p>index 2: tasks index <span class="math notranslate nohighlight">\((i)_i\)</span></p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple with length, logits, targets, ground turths and index</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="peerannot.models.identification.WAUM_perworker.WAUM_perworker.get_aum">
<span class="sig-name descname"><span class="pre">get_aum</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#peerannot.models.identification.WAUM_perworker.WAUM_perworker.get_aum" title="Link to this definition">¶</a></dt>
<dd><p>Records prediction scores of interest for the AUM during n_epoch training epochs for each worker</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="peerannot.models.identification.WAUM_perworker.WAUM_perworker.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#peerannot.models.identification.WAUM_perworker.WAUM_perworker.reset" title="Link to this definition">¶</a></dt>
<dd><p>Reload the model and optimizer from the last checkpoint. The checkpoint path is <code class="docutils literal notranslate"><span class="pre">./temp/checkpoint_waum.pth</span></code>. The classifier backbone is reset between each worker in this version of the WAUM.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="peerannot.models.identification.WAUM_perworker.WAUM_perworker.get_psuccess">
<span class="sig-name descname"><span class="pre">get_psuccess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">probas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pij</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#peerannot.models.identification.WAUM_perworker.WAUM_perworker.get_psuccess" title="Link to this definition">¶</a></dt>
<dd><p>From the classifier associated to worker j <span class="math notranslate nohighlight">\(\mathcal{C}^{(j)}\)</span>, computes weights as:</p>
<div class="math notranslate nohighlight">
\[s_i^{(j)}=\sum_{k=1}^K \sigma(\mathcal{C}^{(j)}(x_i))_k \pi^{(j)}_{k,k}\]</div>
<p>If one wishes to modify the weight, they only need to modify this function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>probas</strong> (<em>torch.Tensor</em>) – Output predictions of neural network classifier</p></li>
<li><p><strong>pij</strong> (<em>torch.tensor</em>) – Confusion matrix of worker j</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Weight in the WAUM</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="peerannot.models.identification.WAUM_perworker.WAUM_perworker.get_psi1_waum">
<span class="sig-name descname"><span class="pre">get_psi1_waum</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#peerannot.models.identification.WAUM_perworker.WAUM_perworker.get_psi1_waum" title="Link to this definition">¶</a></dt>
<dd><p>To use the original margin from Pleiss et al. (2020):</p>
<div class="math notranslate nohighlight">
\[\sigma(\mathcal{C}^{(j)}(x_i))_{y_i^{(j)}} - \max_{k\neq y_i^{(j)}} \sigma(\mathcal{C}^{(j)}(x_i))_{k}\]</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="peerannot.models.identification.WAUM_perworker.WAUM_perworker.get_psi5_waum">
<span class="sig-name descname"><span class="pre">get_psi5_waum</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#peerannot.models.identification.WAUM_perworker.WAUM_perworker.get_psi5_waum" title="Link to this definition">¶</a></dt>
<dd><p>To use the margin for top-2 (or top-k):</p>
<div class="math notranslate nohighlight">
\[\sigma(\mathcal{C}^{(j)}(x_i))_{y_i^{(j)}} - \sigma(\mathcal{C}^{(j)}(x_i))_{[2]}\]</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="peerannot.models.identification.WAUM_perworker.WAUM_perworker.cut_lowests">
<span class="sig-name descname"><span class="pre">cut_lowests</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#peerannot.models.identification.WAUM_perworker.WAUM_perworker.cut_lowests" title="Link to this definition">¶</a></dt>
<dd><p>Identify tasks with lowest WAUM</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – quantile for identification, defaults to 0.01</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="peerannot.models.identification.WAUM_perworker.WAUM_perworker.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#peerannot.models.identification.WAUM_perworker.WAUM_perworker.run" title="Link to this definition">¶</a></dt>
<dd><p>Run WAUM identification and label aggregation using the cut-off hyperparameter alpha</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – WAUM quantile below which tasks are removed, defaults to 0.01</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="peerannot.models.identification.WAUM_perworker.WAUM_perworker.get_probas">
<span class="sig-name descname"><span class="pre">get_probas</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#peerannot.models.identification.WAUM_perworker.WAUM_perworker.get_probas" title="Link to this definition">¶</a></dt>
<dd><p>Get soft labels distribution for each task</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Weighted label frequency for each task</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1.dev0)">numpy.ndarray</a>(n_task, n_classes)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="peerannot.models.identification.WAUM_perworker.WAUM_perworker.get_answers">
<span class="sig-name descname"><span class="pre">get_answers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#peerannot.models.identification.WAUM_perworker.WAUM_perworker.get_answers" title="Link to this definition">¶</a></dt>
<dd><p>Argmax of soft labels, in this case corresponds to a majority vote</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Hard labels</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1.dev0)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

</section>
</dd></dl>

<span class="target" id="sphx-glr-backreferences-peerannot-models-identification-waum-perworker-waum-perworker"></span></section>

</article>
        <aside class="nftt-toc">
          
          <div class="mt-3 mb-1 my-lg-0 ps-xl-3 text-muted">
            <button class="btn btn-link link-dark p-lg-0 mb-2 mb-lg-0 text-decoration-none nftt-toc-toggle d-lg-none" type="button" data-bs-toggle="collapse" data-bs-target="#tocContents" aria-expanded="false" aria-controls="tocContents"
            >On this page <i class="ms-2 bi bi-chevron-expand"></i></button>
            <div class="title d-none d-lg-block">
              <i class="bi bi-file-earmark-text"></i>&nbsp;&nbsp;<span class="small">On this page</span>
            </div>
            <div class="collapse nftt-toc-collapse" id="tocContents">
              <nav id="TableOfContents">
                <ul>
<li><a class="reference internal" href="#">WAUM_perworker</a><ul>
<li><a class="reference internal" href="#peerannot.models.identification.WAUM_perworker.WAUM_perworker"><code class="docutils literal notranslate"><span class="pre">WAUM_perworker</span></code></a><ul>
<li><a class="reference internal" href="#peerannot.models.identification.WAUM_perworker.WAUM_perworker.__init__"><code class="docutils literal notranslate"><span class="pre">WAUM_perworker.__init__()</span></code></a></li>
<li><a class="reference internal" href="#peerannot.models.identification.WAUM_perworker.WAUM_perworker.run_DS"><code class="docutils literal notranslate"><span class="pre">WAUM_perworker.run_DS()</span></code></a></li>
<li><a class="reference internal" href="#peerannot.models.identification.WAUM_perworker.WAUM_perworker.make_step"><code class="docutils literal notranslate"><span class="pre">WAUM_perworker.make_step()</span></code></a></li>
<li><a class="reference internal" href="#peerannot.models.identification.WAUM_perworker.WAUM_perworker.get_aum"><code class="docutils literal notranslate"><span class="pre">WAUM_perworker.get_aum()</span></code></a></li>
<li><a class="reference internal" href="#peerannot.models.identification.WAUM_perworker.WAUM_perworker.reset"><code class="docutils literal notranslate"><span class="pre">WAUM_perworker.reset()</span></code></a></li>
<li><a class="reference internal" href="#peerannot.models.identification.WAUM_perworker.WAUM_perworker.get_psuccess"><code class="docutils literal notranslate"><span class="pre">WAUM_perworker.get_psuccess()</span></code></a></li>
<li><a class="reference internal" href="#peerannot.models.identification.WAUM_perworker.WAUM_perworker.get_psi1_waum"><code class="docutils literal notranslate"><span class="pre">WAUM_perworker.get_psi1_waum()</span></code></a></li>
<li><a class="reference internal" href="#peerannot.models.identification.WAUM_perworker.WAUM_perworker.get_psi5_waum"><code class="docutils literal notranslate"><span class="pre">WAUM_perworker.get_psi5_waum()</span></code></a></li>
<li><a class="reference internal" href="#peerannot.models.identification.WAUM_perworker.WAUM_perworker.cut_lowests"><code class="docutils literal notranslate"><span class="pre">WAUM_perworker.cut_lowests()</span></code></a></li>
<li><a class="reference internal" href="#peerannot.models.identification.WAUM_perworker.WAUM_perworker.run"><code class="docutils literal notranslate"><span class="pre">WAUM_perworker.run()</span></code></a></li>
<li><a class="reference internal" href="#peerannot.models.identification.WAUM_perworker.WAUM_perworker.get_probas"><code class="docutils literal notranslate"><span class="pre">WAUM_perworker.get_probas()</span></code></a></li>
<li><a class="reference internal" href="#peerannot.models.identification.WAUM_perworker.WAUM_perworker.get_answers"><code class="docutils literal notranslate"><span class="pre">WAUM_perworker.get_answers()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

              </nav>
            </div>
          </div>
          
        </aside>
      </div>
    </div>

    <footer class="nftt-footer">
      <nav id="paginator" class="py-4" aria-label="Documentation navigation">
    <div class="container">
      <ul class="pagination justify-content-between mb-0"><li class="page-item">
            <a href="peerannot.models.identification.entropy.Entropy.html" class="d-flex px-5 align-items-end" rel="prev" aria-label="Previous page: Entropy">
              <span class="prev-page"><i class="bi bi-caret-left"></i></span>
              <div class="d-flex flex-column">
                <span class="text-small text-start text-muted">Previous</span>
                <span class="underline">Entropy</span>
              </div>
            </a>
          </li>
        <li class="page-item ms-auto">
            <a href="peerannot.models.identification.WAUM.WAUM.html" class="d-flex px-5 align-items-end" rel="next" aria-label="Next page: WAUM">
              <div class="d-flex flex-column">
                <span class="text-small text-end text-start text-muted">Next</span>
                <span class="underline">WAUM</span>
              </div>
              <span class="next-page"><i class="bi bi-caret-right"></i></span>
            </a>
          </li>
        
      </ul>
    </div>
  </nav>

      <div class="py-5 px-4 px-md-3">
  <div class="container">
    

    <div class="row">
      <div class="col-lg-12 text-center">
        <a class="brand-text d-inline-flex align-items-center mb-2 text-decoration-none" href="/" aria-label="Nefertiti-for-Sphinx">
          <span class="fs-6 fw-bold">peerannot</span>
        </a>
        
          <ul class="list-unstyled small text-muted">
            <li>2023-2024</li>
          </ul>
        
        
        <div class="built-with pt-2">
          Built with <a href="http://sphinx-doc.org">Sphinx 7.3.7</a> and <a href="https://github.com/danirus/sphinx-nefertiti">Nefertiti 0.3.2</a>
        </div>
        
      </div>
    </div>
  </div>
</div>
    </footer>
    <script src="../../_static/documentation_options.js?v=ddba79f2"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=30646c52"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <script type="text/javascript" src="../../_static/sphinx-nefertiti-0.3.2.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap.bundle-0.3.2.min.js"></script>
    
    <script type="text/javascript" src="../../_static/doc_versions.js"></script>
  </body>
</html>